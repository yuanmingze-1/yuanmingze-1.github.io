const m=(a,b)=>{const c=document.createElement("canvas");c.width=a;c.height=b;return c},aa=(a,b,c,d,e,f,h)=>{for(let g=c;g<c+8;++g)for(let k=b;k<b+8;++k){const l=g*d+k,p=h[f[e[a.data[4*l]/85|0]??0]??0]??[];for(let n=0;4>n;++n)a.data[4*l+n]=p[n]??255}},q=(a,b,c)=>{var d=ba;if(void 0!==a){var e=m(a.width,a.height),f=e.getContext("2d");f.drawImage(a,0,0);var h=f.getImageData(0,0,a.width,a.height),g=e.width/8|0,k=e.height/8|0,l=0;for(let p=0;p<k;++p)for(let n=0;n<g;++n){if(l>=b.length)continue;const B=
(b[l]??"0000").split("").map(J=>parseInt(J,32));aa(h,8*n,8*p,a.width,B,d,c);++l}f.putImageData(h,0,0);return e}},r=(a,b,c,d,e,f,h)=>{const g=m(c,d),k=g.getContext("2d");k.font=b;k.textAlign="center";a=a.split("\n");for(--f;0<=f;--f){k.fillStyle=0==f?"#ffffff":"#000000";b=0;for(var l of a)k.fillText(l,c/2,f+(b+1)*e),++b}e=k.getImageData(0,0,c,d);for(l=0;l<c*d;++l)if(127>e.data[4*l+3])e.data[4*l+3]=0;else{f=128<e.data[4*l]?0:1;for(a=0;3>a;++a)e.data[4*l+a]=h[f][a];e.data[4*l+3]=255}k.putImageData(e,
0,0);return g},t=(a,b,c)=>{const d=m(a,b);c(d.getContext("2d"),a,b);return d};const ba=[4,0,511,146,292,438,232,376,208,200,272,344,490,366,400,221,507,480,239,339,485,502,93,383],ca="1042 1043 1452 1452 1452 1453 10BC 10BC 1042 1043 1452 1453 1452 1453 10A9 10A9 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1067 1000 1000 1000 1000 10BC 10B9 1080 1080 1000 1000 10EG 000A 10BC 10B9 1080 1080 10D2 10D2 100B 1067 10D2 10DF 108A 108A 10D2 10D2 1000 1000 10DF 10DF 10DF 10DF 10HG 10HG 10HG 0007 000H 000I 10EH 10EH 10HG 10HG 10HG 4052 4052 4052 10EH 10EH 10LK 10LK 10KJ 10KJ 10KL 10KJ J000 J000 10JK 10JK 100J 100J 10KL 10KJ J000 J000 10IN 10IN 10IN 10MN 100M 100M 0000 0000 10MI 10MI 10IN 10MN 100M 100M 0000 0000".split(" "),
da=(a,b)=>{const c=q(b.J(1),ca,a);u(b,2,t(c.width,c.height,d=>{d.fillStyle="rgba(0,0,0,0.25)";d.fillRect(15,15,1,1);d.fillStyle="#dbdbdb";d.fillRect(2,2,12,12);d.fillStyle="#924900";d.fillRect(37,38,6,9);d.fillStyle="#ffb6db";d.fillRect(35,83,11,11);d.drawImage(c,0,0)}))},ea=(a,b)=>{const c=b.J(0),d=q(c,Array(64).fill("0002"),a),e=q(c,Array(64).fill("0001"),a);u(b,3,d);u(b,4,q(c,Array(64).fill("000G"),a));u(b,5,e);u(b,6,t(256,64,f=>{for(let h=0;4>h;++h)for(let g=0;16>g;++g){const k=16*g+4,l=16*h+
6;for(let p=-1;1>=p;++p)for(let n=-1;1>=n;++n)f.drawImage(e,8*g,8*h,8,8,k+p,l+n,8,8);f.drawImage(d,8*g,8*h,8,8,k,l,8,8)}}))};const v=(a,b,c,d,e)=>{for(let f=2;0<=f;--f)a.fillRect(b-f,c-f,d+2*f,e+2*f,["#000000","#929292","#ffffff"][f])};class w{constructor(a=0,b=0){this.clone=()=>new w(this.x,this.y);this.x=a;this.y=b}get length(){return Math.hypot(this.x,this.y)}};const x=(a,b)=>{b|=0;return((a|0)%b+b)%b};function ia(a,b,c,d=!0){let e=void 0;d&&(e=document.createElement("div"),e.id="d",e.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1;"));a.g=document.createElement("canvas");a.g.setAttribute("style","position: absolute;z-index: -1;image-rendering: optimizeSpeed;image-rendering: pixelated;image-rendering: -moz-crisp-edges;");a.g.width=b;a.g.height=c;d&&void 0!==e&&(e.appendChild(a.g),document.body.appendChild(e));a.D=a.g.getContext("2d");a.D.imageSmoothingEnabled=!1;a.D.globalAlpha=
1}function y(a){var b=window.innerWidth,c=window.innerHeight,d=b/c;let e,f;d>=a.j/a.i?(e=Math.round(d*a.i),d=a.i,f=c/a.i):(e=a.j,d=Math.round(a.j/d),f=b/a.j);e=Math.min(e,a.m)|0;d=Math.min(d,a.l)|0;a.g.width=e;a.g.height=d;a.g.style.width=String(e*f|0)+"px";a.g.style.height=String(d*f|0)+"px";a.g.style.left=String(b/2-f*e/2|0)+"px";a.g.style.top=String(c/2-f*d/2|0)+"px"}function z(a,b=1){a.D.globalAlpha=Math.max(0,Math.min(b,1))}
function A(a,b,c,d,e){d|=0;e|=0;if(!(d>=e)){b=b+a.h.x|0;c=c+a.h.y|0;for(let g=-e;g<=e;++g){var f=g/e;f=Math.round(Math.sqrt(1-f*f)*e);if(!(0>=f)){var h=0;Math.abs(g)<d&&(h=g/d,h=Math.round(Math.sqrt(1-h*h)*d));0>=h?a.D.fillRect(b-f,c+g,2*f,1):(a.D.fillRect(b-f,c+g,f-h,1),a.D.fillRect(b+h,c+g,f-h,1))}}}}
function C(a,b,c=0,d=0,e=0,f=0,h=0,g,k,l,p,n){b=a.J?.(b);if(void 0!==b){g??(g=b?.width??0);k??(k=b?.height??0);l??(l=g/2);p??(p=k/2);d=d+a.h.x|0;e=e+a.h.y|0;f|=0;h|=0;g|=0;k|=0;d|=0;e|=0;a=a.D;var B=0!=c||void 0!==n;B&&a.save();0!=(c&1)&&(a.translate(g,0),a.scale(-1,1),d*=-1);0!=(c&2)&&(a.translate(0,k),a.scale(1,-1),e*=-1);void 0!==n&&(a.translate(l+d|0,p+e|0),a.rotate(-n),d=-l,e=-p);a.drawImage(b,f,h,g,k,d,e,g,k);B&&a.restore()}}
function D(a,b,c,d,e,f=0,h=0,g=0){b=a.J?.(b);if(void 0!==b){var k=b.width/16|0;d=d+a.h.x|0;e=e+a.h.y|0;var l=(c.length+1)*(k+f);1==g?d-=l/2|0:2==g&&(d-=l|0);g=d;for(l=0;l<c.length;++l){const p=c.charCodeAt(l);10==p?(g=d,e+=k+h):(a.D.drawImage(b,p%16*k,((p/16|0)-2)*k,k,k,g,e,k,k),g+=k+f)}}}
class ja{get width(){return this.g.width}get height(){return this.g.height}constructor(a,b=a?.width??0,c=a?.height??0,d=b,e=c,f=()=>{},h=!1){this.h=new w;this.J=()=>{};this.j=b;this.m=d;this.i=c;this.l=e;this.J=f;null!==a?(this.g=a,this.D=a.getContext("2d")):(ia(this,b,c,h),h&&(y(this),window.addEventListener("resize",()=>y(this))))}clear(a){const b=this.D;b.fillStyle=a;b.fillRect(0,0,this.width,this.height)}setColor(a="#ffffff"){this.D.fillStyle=a}fillRect(a=0,b=0,c=this.width,d=this.height,e){void 0!==
e&&this.setColor(e);a=a+this.h.x|0;b=b+this.h.y|0;this.D.fillRect(a,b,c|0,d|0)}move(a,b=0){this.h.x+=a;this.h.y+=b}moveTo(a=0,b=0){this.h.x=a;this.h.y=b}};class ka{constructor(){this.h=!1;this.g=1;const a="    CONTROLS:;;ARROWS:       MOVE;ESC/ENTER:    PAUSE;R:            RESTART;BACKSPACE/Z:  UNDO".split(";");this.width=Math.max(...a.map(b=>b.length));this.height=a.length}N(){this.h&&(this.g=0)}update(a){const b=1/30;this.h&&0>=this.g?E(a,"ls",a):0<this.g?0>=(this.g-=b*a.B)&&(this.h?E(a,"ls",a):this.g=0):a.ba&&(F(a,11),this.h=!0,this.g=1)}X(a){a.clear("#000000");a.moveTo();if(!(this.h&&0>=this.g)){var b=0,c=0,d=7*this.width+8,e=12*this.height+8;if(0<
this.g){const f=this.h?-(1-this.g):this.g;a.width>=a.height?c=a.height*f:b=a.width*f}b=a.width/2-d/2+b;c=a.height/2-e/2+c;v(a,b,c,d,e);D(a,3,"    CONTROLS:\n\nARROWS:       MOVE\nESC/ENTER:    PAUSE\nR:            RESTART\nBACKSPACE/Z:  UNDO",b+4,c+4,-1,4)}}};const G=(a,b,c)=>{0>=b||(a.setColor("rgba(0,0,0,"+String((7*(c?1-b:b)|0)/7)+")"),a.fillRect(),a.setColor())};class la{constructor(){this.g=0;this.h=!1}N(){this.h=!1;this.g=1}update(a){0<this.g?0>(this.g-=.05*a.B)&&(this.h&&E(a,"t",a),this.g=0):a.ba&&(this.g=1,this.h=!0,F(a,11))}X(a){a.clear("#000000");D(a,3,"THANK YOU FOR PLAYING!",a.width/2,a.height/2-4,-1,0,1);G(a,this.g,this.h)}};const ma=["square","triangle","sawtooth","sine"];
class na{constructor(a,b,c,d,e){this.i=0;this.j=void 0;this.h=a;this.g=Array.from(b);this.l=c;this.type=d;this.m=e;this.i=.4}play(a){const b=this.h.currentTime,c=this.h.createOscillator(),d=this.h.createGain(),e=["setValueAtTime","linearRampToValueAtTime","exponentialRampToValueAtTime"][this.m];c.type=ma[this.type]??"square";a*=this.l;let f=this.g[2]*a;c.frequency.setValueAtTime(this.g[0],b);d.gain.setValueAtTime(this.i*f,b);let h=0;for(let g=0;g<this.g.length;g+=3){const k=this.g[g],l=this.g[g+1];
f=Math.max(1E-4,Math.min(this.g[g+2]*a,1));c.frequency[e](k,b+h);d.gain[e](f,b+h);h+=1/60*l}d.gain.exponentialRampToValueAtTime(.5*f,b+h);c.connect(d).connect(this.h.destination);c.start(b);c.stop(b+h);c.onended=()=>c.disconnect();this.j?.disconnect();this.j=c}};class oa{constructor(a,b){this.keys=Array.from(a);this.L=Array.from(b)}}function u(a,b,c){a.m.set(b,c)}function H(a,b,c,d=1,e=0,f=2){a.F.set(b,new na(a.l,c,d,e,f))}function E(a,b,c){b=a.H.get(b);b?.N?.(a.g?.ca?.(),c);a.g=b??a.g}function F(a,b,c=.6){if(a.j)try{a.F.get(b)?.play(.6*c)}catch(d){}}function I(a,b,c){a.keys.get(b)!==c-2&&(a.keys.set(b,c),a.h||(a.h=!!(c&1)))}function K(a,b,c){a.L.get(b)!==c-2&&(a.L.set(b,c),a.h||(a.h=!!(c&1)))}
function L(a){for(var b of a.keys.keys()){const c=a.keys.get(b)??0;1<c&&a.keys.set(b,c-2)}for(const c of a.L.keys())b=a.L.get(c)??0,1<b&&a.L.set(c,b-2);a.h=!1}function M(a,b,c,d=[]){a.actions.set(b,new oa(c,d));a.A.push(...c);a.C.push(...d)}function N(a,b){b=a.actions.get(b);if(void 0===b)return 0;for(var c of b.keys){const d=a.keys.get(c)??0;if(0!=d)return d}for(const d of b.L)if(c=a.L.get(d)??0,0!=c)return c;return 0}
function O(a,b,c){++a.i;const d=new Image;d.onload=()=>{++a.u;a.m.set(b,d)};d.src=c}function pa(a){a.l=new AudioContext;try{a.l.resume()}catch(b){}}function P(a,b,c,d=!1){a.H.set(b,c);if(void 0===a.g||d)a.g=c}
class qa{get ba(){return this.h}constructor(){this.B=1;this.h=!1;this.i=this.u=0;this.g=this.l=void 0;this.loaded=()=>this.u>=this.i;this.K=()=>0==this.i?1:this.u/this.i;this.ia=()=>{this.j=!this.j};this.Y=()=>"AUDIO: "+(this.j?"ON ":"OFF");this.keys=new Map;this.A=[];this.L=new Map;this.C=[];this.actions=new Map;window.addEventListener("keydown",a=>{(this.A.includes(a.code)||this.C.includes(a.key))&&a.preventDefault();I(this,a.code,3);K(this,a.key,3)});window.addEventListener("keyup",a=>{(this.A.includes(a.code)||
this.C.includes(a.key))&&a.preventDefault();I(this,a.code,2);K(this,a.key,2)});window.addEventListener("mousedown",()=>{window.focus()});window.addEventListener("mousemove",()=>{window.focus()});window.addEventListener("contextmenu",a=>a.preventDefault());this.m=new Map;this.F=new Map;this.j=!0;this.H=new Map}J(a){return this.m.get(a)}};function Q(a,b){a=Array.from(a.g);for(const c in a)b.includes(a[c])||(a[c]=0);return a}
class ra{constructor(a){this.width=parseInt(a[0])+2;this.height=parseInt(a[1])+2;a=a.substring(2).split("").map(c=>parseInt(c,32));this.g=Array(this.width*this.height).fill(1);let b=0;for(let c=1;c<this.height-1;++c)for(let d=1;d<this.width-1;++d)this.g[c*this.width+d]=a[b++]}G(a,b,c=0){return 0>a||0>b||a>=this.width||b>=this.height?c:this.g[b*this.width+a]}aa(a){for(let b=0;b<this.height;++b)for(let c=0;c<this.width;++c){const d=b*this.width+c;a(this.g[d],c,b,d)}}};const sa="65700107400300240131011107030040 56700001030200107551113040000107 65012617706600045010664636701007 65200167113036700604061101060608 66783417411030630415406016361615700320 567430701B3B0161200000B09107B067 6571CB7C40C02013C0900560BB70C4B7 750007008BB6BBBB03C1090CC0051195002C7 660DDD57E1BB35E17B39E11G11CFFF6720DD06 667001B7CCC55B0303010F11081001117D2D49 667BDD0HBBFF5D00E01110E0F50660F5267619 76H18005H00F5FF0011EGBB5100FB7E1011117324DD9 86BHB8B8195B50BB16158EGGGG0E11020361C3D037917C3D60".split(" ");const ta=(a,b,c,d,e)=>{a.setColor("#dbdbdb");for(let g=0;g<2*e;++g)for(let k=0;k<2*d;++k){var f=c[g*d*2+k]-1;if(0<=f){var h=f%4;f=f/4|0;z(a,.25);C(a,2,0,8*k,8*g,8*h,32+8*f,8,8);z(a)}h=b[g*d*2+k]-1;-2!=h&&(-1==h?a.fillRect(8*k,8*g,8,8):C(a,2,0,8*k,8*g,h%6*8,8*(h/6|0),8,8))}};const ua=[1,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],va=[2,3],wa=[1,11],xa=[6,9,17];function R(a,b,c,d,e,f=0){0>b||b>=a.v.length||0>c||0>d||c>=a.width||d>=a.height||(a.v[b][d*a.width+c]=e&31|f<<5)}function S(a,b,c){for(let d=0;d<a.v[0].length;++d){if(0!=a.v[1][d])continue;const e=a.v[0][d];e==b?a.v[0][d]=c:e==c&&(a.v[0][d]=b)}}
class T{constructor(a,b){this.s=13;this.v=Array(2);void 0!==a?(this.s=a.s,this.width=a.width,this.height=a.height,this.v[0]=Array.from(a.v[0]),this.v[1]=Array.from(a.v[1])):(this.width=b.width,this.height=b.height,this.v[0]=Q(b,ua),this.v[1]=Q(b,va))}G(a,b,c){return 0>a||a>=this.v.length||0>b||0>c||b>=this.width||c>=this.height?0:this.v[a][c*this.width+b]&31}aa(a){for(let b=0;b<this.height;++b)for(let c=0;c<this.width;++c)a(this.v[0][b*this.width+c],this.v[1][b*this.width+c],c,b)}};const ya=[6,9,17];class za{constructor(){this.g=new w;this.O=0}update(a){this.O=Math.max(0,this.O-=1/24*a.B)}M(a){0>=this.O||C(a,2,0,this.g.x-4,this.g.y-4,24+8*(3*(1-this.O)|0),72,8,8)}}const U=a=>new w([0,1,0,-1,0][a]??0,[0,0,-1,0,1][a]??0);function Aa(a){a.j=0;a.I=!1;a.h=0;a.target=a.g.clone();a.o.x=16*a.g.x;a.o.y=16*a.g.y;a.active=!1}
class V{constructor(a,b,c,d){this.h=0;this.direction=4;this.active=!0;this.u=this.j=this.l=0;this.i=this.m=this.I=!1;this.g=new w(b,c);this.target=this.g.clone();this.o=new w(16*b,16*c);this.type=a;this.C=Array(8).fill(void 0).map(()=>new za);this.A=d}moveTo(a,b,c,d){var e=3==this.type||0>=a.s||this.i&&4!=a.G(0,b,c),f=a.G(0,b,c);if(0!=a.G(1,b,c)||!e&&4==f||e&&xa.includes(f)||wa.includes(f))return!1;R(a,1,this.g.x,this.g.y,0);this.active&&2==this.type&&(e=0>=a.s,f=a.G(0,this.g.x,this.g.y),e||5!=f||
(R(a,0,this.g.x,this.g.y,4),this.A(1,this.g.x,this.g.y),F(d,3)),e&&0==f&&(R(a,0,this.g.x,this.g.y,6),this.A(3,this.g.x,this.g.y),F(d,4)));this.h=0;this.I=!0;this.target=new w(b,c);this.m=!1;2==this.type&&ya.includes(a.G(0,b,c))&&(this.m=!0,F(d,6));3==this.type&&F(d,0);return!0}move(a,b,c){this.I&&(1<=(this.h+=b*c.B)&&(this.h=0,this.I=!1,this.g=this.target.clone(),R(a,1,this.g.x,this.g.y,this.type,this.direction)),this.o.x=16*((1-this.h)*this.g.x+this.h*this.target.x),this.o.y=16*((1-this.h)*this.g.y+
this.h*this.target.y))}control(a,b,c=!1){if(!this.active||this.I)return!1;var d=3==this.type;if(2!=this.type&&!d)return!1;if(c)var e=0;else 2==this.type&&0>=a.s?e=0:(e=a.G(0,this.g.x,this.g.y),e=13<=e&&16>=e?1+(e-13):0);this.i=0!=e;if(!this.i)for(var f=0;4>f;++f)if(0!=(N(b,f)&1)){e=f+1;break}f=U(e);return!this.i&&d&&(0>=a.s||2!=a.G(1,this.g.x-f.x,this.g.y-f.y))?!1:0!=e?(this.direction=e,(d=this.moveTo(a,this.g.x+f.x,this.g.y+f.y,b))||!this.i||c?d:this.control(a,b,!0)):!1}update(a,b,c){const d=1/60;
if(this.active){if(!(2!=this.type||0>=a.s)){for(var e of this.C)e.update(c);if(!this.i&&!this.m&&this.I&&8<=(this.u+=c.B)){this.u-=8;for(var f of this.C)if(0>=f.O){e=U(this.direction);f.g=new w(this.o.x+8-6*e.x,this.o.y+8-4*e.y);f.O=1;break}}}this.move(a,b,c);this.l=(this.l+d*c.B)%1}else 0<this.j&&(this.j-=c.B)}F(a,b){if(!(2!=this.type||0>=b.s))for(let c of this.C)c.M(a)}M(a,b){if(this.active)switch(this.type){case 2:if(0>=b.s){b=[6,0,-4,0];var c=[0,0,0,1],d=this.o.y-7+Math.round(Math.sin(this.l*
Math.PI*2));C(a,2,0,this.o.x,d,0,48,16,16);2!=this.direction&&C(a,2,0,this.o.x+4+b[this.direction-1],d+c[this.direction-1]+5,16+(3==this.direction?2:0),40,4==this.direction?8:6,8)}else if(b=this.o.y-6,c=(2*this.h|0)+2*Number(this.g.x%2==this.g.y%2),this.i?c=0:this.I&&this.m&&(b-=4*Math.sin(this.h*Math.PI),c=3),0==this.direction%2){d=Number(3==c);var e=c%2;const f=1-(this.direction/3|0);C(a,2,d,this.o.x,b+e,0,16+8*f,16,8);C(a,2,d,this.o.x,b+8,32+c%2*16,16,16,8);a.fillRect(this.o.x+6,b+9+e-2*f,4,1,
"#000000")}else d=Number(3==this.direction),C(a,2,d,this.o.x,b+c%2,16,16,16,8),C(a,2,d,this.o.x,b+8,16+16*[0,1,0,2][c],24,16,8);break;case 3:C(a,2,0,this.o.x,this.o.y-1,32,32,16,16);break;case 7:c=(8*this.l|0)%4;d=[12,8,4,8][c];e=this.o.x+8-d/2;0<b.s&&z(a,.33);C(a,2,Number(3==c),e,this.o.y-3+Math.round(Math.sin(this.l*Math.PI*2+Number(this.g.x%2==this.g.y%2)*Math.PI)),[0,12,20,12][c],64,d,12);z(a);break;case 8:0<b.s&&z(a,.33),b=this.o.y-5+Math.round(Math.sin(this.l*Math.PI*2+Number(this.g.x%2==this.g.y%
2)*Math.PI)),C(a,2,0,this.o.x,b,48,64,16,16),C(a,2,0,this.o.x,b,16,48,16,8),z(a)}else 0<this.j&&7==this.type&&(b=1-this.j/12,a.setColor("#ff9200"),A(a,this.o.x+8,this.o.y+9,9*b,2+10*b),a.setColor("#ffff49"),A(a,this.o.x+7,this.o.y+8,10*b,2+10*b))}setPosition(a,b,c=4){this.g=new w(a,b);this.target=this.g.clone();this.direction=0==c?4:c;this.o.x=16*this.g.x;this.o.y=16*this.g.y;this.active=!0}W(a,b){if(!this.active)return!1;const c=a.G(0,this.g.x,this.g.y);3==this.type&&4==c&&(this.active=!1,R(a,0,
this.g.x,this.g.y,0),R(a,1,this.g.x,this.g.y,0),this.A(2,this.g.x,this.g.y),F(b,1,.6));2==this.type&&0<a.s&&(6==c||9==c||17==c)&&(R(a,0,this.g.x,this.g.y,6==c?0:c+1),6==c?this.A(4,this.g.x,this.g.y):9==c?S(a,11,12):17==c&&(S(a,13,15),S(a,14,16)),F(b,2));if(2==this.type&&0>=a.s&&7==c)return R(a,0,this.g.x,this.g.y,0),F(b,5),!0;7!=this.type&&8!=this.type||c==this.type||(--this.o.y,this.active=!1,this.j=12);return 2==this.type&&0>=a.s&&8==c?(R(a,0,this.g.x,this.g.y,0),F(b,5),a.s=14,!0):!1}};class W{constructor(a,b){this.evaluate=c=>this.g(c,this);this.text=a;this.g=b}clone(){return new W(this.text,this.g)}}function X(a,b=a.g){a.g=x(b,a.buttons.length);a.active=!0}
class Y{constructor(a,b=!1){this.g=0;this.active=!1;this.buttons=a.map((c,d)=>a[d].clone());this.active=b;this.width=Math.max(...this.buttons.map(c=>c.text.length+2));this.height=this.buttons.length}update(a,b=!1){this.active&&(b&&3==N(a,8)?(F(a,12),this.active=!1):(b=this.g,3==N(a,1)?--this.g:3==N(a,3)&&++this.g,b!=this.g&&(this.g=x(this.g,this.buttons.length),F(a,8)),3==N(a,4)&&(this.buttons[this.g].evaluate(a)&&(this.active=!1),F(a,11))))}M(a,b=0,c=0,d=!1){if(this.active)for(d&&(a.setColor("rgba(0,0,0,0.5)"),
a.fillRect()),b=a.width/2-4*this.width+b,c=a.height/2-12*this.height/2+c,v(a,b,c,8*this.width,12*this.height),d=0;d<this.buttons.length;++d)D(a,3+Number(d==this.g),(d==this.g?"$%":"")+this.buttons[d].text,b+2,c+2+12*d,-1)}};const Ba=()=>{const a=Array(12).fill(!1);try{const b=(window.localStorage.getItem("jn2024_2")??"").split("").map(c=>1==Number(c));for(let c=0;c<b.length;++c)a[c]=b[c]}catch(b){}return a},Z=a=>{try{const b=a.map(c=>String(Number(c))).join("");window.localStorage.setItem("jn2024_2",b)}catch(b){}};const Ca=[7,8],Da=[2,3];function Ea(a){a.H&&a.i.push(new T(a.i[a.i.length-1]));if(!(2>a.i.length)){var b=a.i[a.i.length-2],c=a.g;for(let d=0;d<b.width*b.height;++d)c.v[0][d]=b.v[0][d],c.v[1][d]=b.v[1][d];c.s=b.s;a.i.pop();Fa(a)}}function Ga(a){a.g=new T(void 0,a.C);13==a.m&&(a.g.s=0);Fa(a);a.i.push(new T(a.g))}function Ha(a){a.g.aa((b,c,d,e)=>{Ca.includes(b)&&a.h.push(new V(b,d,e,a.fa));Da.includes(c)&&(b=new V(c,d,e,a.fa),2==b.type&&(a.u=b),a.h.push(b))})}
function Fa(a){a.H=!1;a.l=0;a.j=0;a.j=0;for(let d of a.h)Aa(d);const b=Array(a.h.length).fill(!1),c=Array(a.h.length).fill(!1);a.g.aa((d,e,f,h)=>{for(var g=0;g<a.h.length;++g){const k=a.h[g];if(!c[g]&&(d&31)==k.type){c[g]=!0;k.setPosition(f,h,d>>5);break}}for(d=0;d<a.h.length;++d)if(g=a.h[d],!b[d]&&(e&31)==g.type){b[d]=!0;g.setPosition(f,h,e>>5);break}})}
function Ia(a,b){var c=13==a.m;b.clear(c?"#b6b6b6":"#4992db");b.setColor(c?"#929292":"#246db6");c=((b.width/32+1)/2|0)+1;const d=((b.height/32+1)/2|0)+1;for(let e=-d-1;e<=d;++e)for(let f=-c-1;f<=c;++f)(e+2*d)%2!=(f+2*c)%2&&b.fillRect(b.width/2-32*f-a.T,b.height/2-32*e+a.T,32,32)}
function Ja(a,b){z(b,.25);b.setColor("#000000");b.fillRect(-2,4,16*a.width+13,16*a.height+12);C(b,2,0,16*a.width+7,-1,16,32,5,5);C(b,2,0,-7,16*a.height+12,24,32,5,5);z(b);b.fillRect(-2,-2,16*a.width+4,16*a.height+4,"#924900");for(var c=-1;c<2*a.width+1;++c){var d=-1==c||c==2*a.width;for(let e=0;2>e;++e)C(b,2,Number(c==2*a.width)|Number(2*e),8*c+Number(0>c),-7+e*(16*a.height+6),d?49:56,0,8-Number(d),8);C(b,2,Number(c==2*a.width),8*c,16*a.height+6,d?48:56,8,8,8)}for(c=0;c<2*a.height;++c)for(d=0;2>d;++d)C(b,
2,d,-7+d*(16*a.width+6),8*c,56,0,8,8,4,4,Math.PI/2)}
function Ka(a,b){b.fillRect(8,8,16*(a.width-1),16*(a.height-1),"#000000");for(let c=1;c<a.height-1;++c)for(let d=1;d<a.width-1;++d){const e=a.g.G(0,d,c),f=16*d,h=16*c;b.fillRect(16*d,16*c,16,16,d%2==c%2?"#ffdb92":"#dbb66d");if(!(0<a.l&&d==a.P.x&&c==a.P.y))switch(e){case 4:C(b,2,0,f,h,48,32,16,16);break;case 5:C(b,2,0,f+4,h+4,24,40,8,8);break;case 6:C(b,2,0,f,h,32,48,16,16);break;case 9:case 10:C(b,2,0,f,h,16*(e-9),80,16,16);break;case 11:case 12:C(b,2,0,f,h,32+16*(e-11),80,16,16);break;case 13:case 14:case 15:case 16:const g=
e%2,k=(e-10)*Math.PI/2,l=(a.$/.5|0)%2;for(let p=0;2>p;++p)C(b,2,2*Number(15==e)+Number(16==e),f+g*(8*p-4),h+(1-g)*p*8+4*g,0,96+(p+l)%2*8,16,8,8,4,k);break;case 17:case 18:C(b,2,0,f,h,16+16*(e-17),96,16,16)}}}
function La(a,b){var c=[24,48,56,48];const d=[40,48,48,32];if(!(0>=a.l)){var e=16*a.P.x,f=16*a.P.y,h=1-a.l;switch(a.ea){case 1:a=Math.min(2,3*h|0);C(b,2,0,e+4,f+4,c[a],d[a],8,8);break;case 2:a=Math.max(1,Math.ceil(3*a.l));h=3==a?16:8;C(b,2,0,e+(16-h)/2,f+(16-h)/2,c[a],d[a],h,h);break;case 3:c=Math.min(2,3*(1-a.l)|0);if(0==c)break;C(b,2,0,e+4,f+4,48+8*(c-1),56,8,8);break;case 4:.5<h||(b.setColor("#6d6db6"),A(b,e+8,f+8,16*h,2+16*h))}}}
function Ma(a,b){D(b,6,13==a.m?"NIGHTMARE":"STAGE "+String(a.m),b.width/2,b.height-19,-8,0,1);if(0==(a.j/4|0)%2){var c=b.width/2+4;if(0>=a.g.s)D(b,6,"SPOOKY!",c,2,-8,0,1);else if(D(b,6,"#",c-22,2),0>=a.A||!a.u.I||a.u.i)D(b,6,String(a.g.s),c,2,-8,0,1);else{var d=1-a.A;z(b,a.A);D(b,6,String(a.g.s),c,2+8*d,-8,0,1);z(b,d);D(b,6,String(a.g.s-1),c,2-8*a.A,-8,0,1);z(b)}}}
function Na(a,b){if(!(0>=a.j)){var c=32*(1-a.j/24),d=(a.j/2|0)%3,e=a.u.o.x+8;a=a.u.o.y+8;var f=2*Math.PI/6;for(let h=0;6>h;++h){const g=f*(h+.5);C(b,2,0,e+Math.cos(g)*c-4,a+Math.sin(g)*c-4,24+8*d,64,8,8)}}}
function Oa(a,b){b.fillRect(0,0,b.width,b.height,"rgba(0,0,0,0.50)");var c=b.J(7);const d=b.width/2-c.width/2;c=b.height/2-c.height/2;if(30<=a.K)C(b,7,0,d,c);else{a=1-a.K/30;const f=b.J(7);if(void 0!==f){var e=1+4*a;for(let h=0;h<f.height;++h)b.D.drawImage(f,0,h,f.width,1,Math.round(d+32*Math.sin(8*Math.PI/f.height*h+4*a*Math.PI)*a),Math.round(c+h*e-4*f.height*a/2),f.width,1)}}}
class Pa{constructor(a){this.g=this.ga=this.ha=this.C=void 0;this.height=this.width=0;this.u=void 0;this.H=!1;this.l=this.ea=0;this.P=new w(0,0);this.da=!0;this.F=this.V=this.T=this.$=this.A=this.j=0;this.S=!1;this.m=0;this.R=!1;this.K=0;this.fa=(b,c,d)=>{this.P.x=c;this.P.y=d;this.ea=b;this.l=1;this.da=4!=b};this.Z=a;this.i=[];this.h=[];this.U=new Y([new W("RESUME",()=>!0),new W("UNDO",()=>{Ea(this);return!0}),new W("RESTART",()=>{Ga(this);return!0}),new W("AUDIO: ON",(b,c)=>{b.ia();c.text=b.Y();
return!1}),new W("QUIT",()=>{this.F=1;return this.S=!0})],!1)}W(a){let b=!1;for(let c of this.h)b=c.W(this.g,a)||b;if(b)for(let c of this.h)c.W(this.g,a)}N(a){this.m=a??1;var b=this.C=new ra(sa[this.m-1]);const c=Array(b.width*b.height*4).fill(-1),d=Array(b.width*b.height*4).fill(0);for(let k=0;k<b.height;++k)for(let l=0;l<b.width;++l){var e=l,f=k,h=b,g=Array(9);for(let p=-1;1>=p;++p)for(let n=-1;1>=n;++n)g[3*(p+1)+(n+1)]=1==h.G(e+n,f+p,1);f=g;1!=b.G(l,k)?(e=d,h=b,g=k*h.width*4+2*l,f[0]?(e[g]=2,f[1]&&
f[3]?e[g]=1:f[1]||f[3]?f[1]||(e[g]=5):e[g]=6):f[1]&&f[3]?e[g]=1:!f[1]&&f[3]?e[g]=3:!f[3]&&f[1]&&(e[g]=4),f[1]&&(e[g+1]=2),f[3]&&(e[g+2*h.width]=5)):(e=c,h=b,g=k*h.width*4+2*l,e[g]=0,f[1]&&f[3]?f[0]||(e[g]=5):(e[g]=1,f[1]?e[g]=4:f[3]&&(e[g]=3)),e[++g]=0,f[1]&&f[5]?f[2]||(e[g]=6):(e[g]=2,f[1]?e[g]=10:f[5]&&(e[g]=3)),e[g+=2*h.width-1]=0,f[7]&&f[3]?f[6]||(e[g]=11):(e[g]=7,f[7]?e[g]=4:f[3]&&(e[g]=9)),e[++g]=0,f[7]&&f[5]?f[8]||(e[g]=12):(e[g]=8,f[7]?e[g]=10:f[5]&&(e[g]=9)))}[this.ha,this.ga]=[c,d];this.width=
this.C.width;this.height=this.C.height;this.i.length=0;this.h.length=0;this.i.push(new T(void 0,this.C));13==this.m&&(this.i[0].s=0);this.g=new T(this.i[0]);this.h.length=0;Ha(this);this.H=!1;this.V=this.T=this.A=this.l=this.j=0;13===a&&(this.V=30);this.F=1;this.R=this.S=!1;this.K=0}update(a){var b=1/60;if(0<this.F)0>(this.F-=.05*a.B)&&(this.S&&E(a,13==this.m&&this.R?"e":"ls",a),this.F=0);else if(this.R){for(var c of this.h)c.update(this.g,.0625,a);this.K+=a.B;if(90<=this.K){if(b=13!=this.m)a:{for(b=
0;12>b;++b)if(!this.Z[b]){b=!1;break a}b=!0}b?(F(a,14),this.N(13,a)):(this.S=!0,this.F=1)}}else if(this.U.active)this.U.update(a,!0);else if(3==N(a,5))F(a,12),this.U.buttons[3].text=a.Y(),X(this.U,0);else if(3==N(a,7))F(a,8),Ea(this);else{3==N(a,6)&&(F(a,9),Ga(this));var d=!1;c=this.u.I;if(0>=this.j&&(0>=this.l||!this.da)){do{var e=!1;for(var f of this.h){const k=f.control(this.g,a);e=k||e;k&&2!=f.type&&(d=!0)}e&&(this.A=1)}while(e)}!c&&this.u.I&&!this.u.m&&!d&&0<this.g.s&&F(a,10);f=this.H;this.H=
!1;for(var h of this.h)h.update(this.g,.0625,a),this.H=h.I||this.H;if(f&&!this.H){this.A=0;this.W(a);h=this.g.s;c&&!this.u.i&&(this.g.s=Math.max(0,this.g.s-1));1==h&&0==this.g.s&&(this.j=24,F(a,7));0<h&&0==this.g.s&&this.W(a);this.u.i||(this.i.push(new T(this.g)),64<=this.i.length&&this.i.shift());13==this.g.s&&(this.j=24,F(a,7));a:{for(g of this.g.v[0])if(7==g){var g=!1;break a}g=!0}if(this.R=g)F(a,13),this.Z[this.m-1]=!0,Z(this.Z)}0<this.l&&(this.l-=.0625*a.B);0<this.j&&(this.j-=a.B);0<this.A&&
(this.A-=.0625*a.B);this.$=(this.$+b*a.B)%1;13==this.m&&(this.T=(this.T+.5*a.B)%32);this.V=Math.max(0,this.V-a.B)}}X(a){Ia(this,a);a.moveTo(a.width/2-8*this.C.width,a.height/2-8*this.C.height);0<this.V&&a.move(-2+(5*Math.random()|0),-2+(5*Math.random()|0));Ja(this,a);Ka(this,a);ta(a,this.ha,this.ga,this.C.width,this.C.height);La(this,a);this.h.sort((b,c)=>b.o.y-c.o.y);z(a,.25);for(let b of this.h)if(b.active)switch(b.type){case 2:case 7:case 8:C(a,2,0,b.o.x,b.o.y+6,16,56,16,8)}z(a);this.u?.F(a,this.g);
for(let b of this.h)b.M(a,this.g);Na(this,a);a.moveTo();Ma(this,a);this.U.M(a,0,0,!0);this.R&&Oa(this,a);G(a,this.F,this.S)}ca(){return Number(this.R)}};const Qa=["#000000","#924900","#ffb66d","#db6d00"],Ra=["#000000","#db9200","#ffffdb","#ffdb6d"],Sa=[0,0,1,2],Ta=[0,0,-1,-1];
class Ua{constructor(a){this.h=new w;this.l=1;this.g=0;this.i=!1;this.j=0;this.m=!1;this.u=a}N(a){this.i=this.m=!1;this.g=1;this.j=0;1===a&&(this.u[this.l-1]=!0)}update(a){var b=1/120;if(0<this.g)0>(this.g-=.05*a.B)&&(this.i&&E(a,this.m?"t":"g",a),this.g=0);else if(3==N(a,8))F(a,11),this.g=1,this.m=this.i=!0;else if(this.j=(this.j+b*a.B)%1,this.l=1+4*this.h.y+this.h.x,3==N(a,4))F(a,11),this.g=1,this.i=!0;else{var c=b=0;3==N(a,0)?b=1:3==N(a,2)&&(b=-1);3==N(a,3)?c=1:3==N(a,1)&&(c=-1);if(0!=b||0!=c)F(a,
8),this.h.x=x(this.h.x+b,4),this.h.y=x(this.h.y+c,3)}}X(a){a.moveTo();a.clear("#246db6");const b=a.width/2-82,c=a.height/2-48;for(let g=0;3>g;++g)for(let k=0;4>k;++k){var d=a,e=1+4*g+k,f=b+44*k,h=c+36*g;const l=this.l==e,p=!0===this.u[e-1]?Ra:Qa;d.fillRect(f+(l?1:3),h+(l?6:8),32,23,"rgba(0,0,0,0.25)");l||(z(d,.25),C(d,2,0,f+32,h+3,16,32,5,5),C(d,2,0,f-1,h+24+4,24,32,4,5),z(d));for(let n=0;4>n;++n){const B=f+n+Ta[n],J=32-2*n+Sa[n];let fa=h+n+Ta[n]+4,ha=24-2*n+Sa[n];l||(fa-=4,2>n&&(ha+=4));d.fillRect(B,
fa,J,ha,p[n])}D(d,6,String(e),f+16-1,h+12-10+(l?4:0),-9,0,1);l&&(e=f+16-8,f=h+12-12-Math.abs(6*Math.sin(6*this.j*Math.PI)),z(d,.25),C(d,2,0,e,h+12,16,56,16,8),z(d),C(d,2,0,e,f,0,16,16,8),C(d,2,0,e,f+8,32,16,16,8),d.fillRect(e+6,f+9,4,1,"#000000"))}D(a,6,"SELECT LEVEL",a.width/2,2,-8,0,1);G(a,this.g,this.i)}ca(){return this.l}};function Va(a,b){b.clear("#000000");a=a.g.K();const c=b.width/2-40,d=b.height/2-6;b.fillRect(c,d,80,12,"#ffffff");b.fillRect(c+1,d+1,78,10,"#000000");b.fillRect(c+2,d+2,76*a,8,"#ffffff")}function Wa(a,b,c,d){const e=1E3/60,f=a.g.loaded();a.h=Math.min(a.h+(b-a.l),5*e);a.l=b;for(b=!0;a.h>=e;a.h-=e){a.i&&a.g.g?.update(a.g);if(f&&!a.i&&a.g.ba){a.i=!0;pa(a.g);d(a.g);a.g.g?.N?.(void 0,a.g);L(a.g);break}b&&(L(a.g),b=!1)}f?a.i?a.g.g?.X(a.j):c(a.j):Va(a,a.j);window.requestAnimationFrame(h=>Wa(a,h,c,d))}
class Xa{constructor(){this.l=this.h=0;this.i=!1;this.j=new ja(null,192,192,576,576,a=>this.g.J(a),!0);this.g=new qa}};class Ya{constructor(a){this.g=0;this.j=!1;this.i=1;this.h=0;this.l=1;this.A=a;this.u=new Y([new W("START GAME",()=>{this.j=!0;this.g=1;return!1}),new W("AUDIO: ON ",(b,c)=>{b.ia();c.text=b.Y();return!1}),new W("DELETE DATA",()=>{X(this.m,1);return!1})],!0);this.m=new Y([new W("YES",()=>{this.A.fill(!1);Z(this.A);return!0}),new W("NO",()=>!0)])}N(a,b){this.g=1;this.j=!1;this.u.buttons[1].text=b.Y()}update(a){const b=1/60,c=1/30,d=1/60,e=1/90;if(1<this.h&&(this.i=(this.i+b*a.B)%1,0<this.l)){this.g=
Math.max(0,this.g-d*a.B);this.l-=e*a.B;return}if(0<this.g){if(0>(this.g-=c*a.B)){if(this.j){if(2>this.h){2==++this.h&&F(a,15);this.j=!1;this.g=1;return}E(a,"c",a)}this.g=0}}else 2>this.h&&45<=(this.i+=a.B)?(this.i=0,this.g=1,this.j=!0):2==this.h&&3==N(a,4)?(this.h=3,F(a,12)):3==this.h&&(this.m.active?this.m.update(a):this.u.update(a,!1))}X(a){a.moveTo();a.clear("#000000");if(2>this.h)D(a,3,0==this.h?"A GAME BY":"MADE FOR",a.width/2,a.height/2-10,-1,0,1),D(a,3,0==this.h?"JANI NYK@NEN":"JS13K 2024",
a.width/2,a.height/2+2,-1,0,1);else{const c=a.J(8),d=a.width/2-c.width/2;for(let e=0;e<c.height;++e){var b=(e-14-c.height/2)/(c.height/2);b=b*b*Math.sign(b);C(a,8,0,d+Math.sin((e/24+this.i)*Math.PI*2)*(2+1024*this.l*b),16+e+1024*this.l*b,0,e,c.width,1)}0<this.l||(3==this.h?this.m.active?(D(a,3,"CLEAR PROGRESS?",a.width/2,a.height/2+8,-1,0,1),this.m.M(a,0,40)):this.u.M(a,0,32,!1):.5>this.i&&D(a,4,"PRESS ENTER OR SPACE",a.width/2,a.height/2+32,-1,0,1),D(a,3,"*2024 JANI NYK@NEN",a.width/2,a.height-12,
-1,0,1))}G(a,this.g,this.j)}ca(){}};const Za=a=>{a.clear("#000000");D(a,0,"PRESS ANY KEY",a.width/2,a.height/2-4,-1,0,1)},$a=a=>{M(a,2,["ArrowLeft"]);M(a,0,["ArrowRight"]);M(a,1,["ArrowUp"]);M(a,3,["ArrowDown"]);M(a,4,["Space","Enter"]);M(a,5,["Escape","Enter"]);M(a,6,[],["r","R"]);M(a,7,["Backspace"],["z","Z"]);M(a,8,["Escape"]);var b=255/7;const c=[];for(let d=0;512>d;++d)c[d]=[(d>>6&7)*b|0,(d>>3&7)*b|0,(d&7)*b|0,4==d?0:255];da(c,a);ea(c,a);u(a,7,r("STAGE\nCLEAR!","bold 22px Arial",96,48,20,3,[[182,255,0],[73,182,0]]));u(a,8,r("GHOSTED",
"bold 32px Arial",192,64,56,6,[[255,182,0],[219,109,0]]));H(a,0,[96,6,1,80,4,.2],.6,2,2);H(a,1,[256,4,1,192,6,.7,160,12,.2],1.15,1,2);H(a,2,[96,3,.6,128,5,1,160,12,.2],.4,0,2);H(a,3,[160,12,1,192,6,.7,256,4,.2],1.15,1,2);H(a,4,[224,2,.7,160,3,1,144,6,.2],1.25,1,2);H(a,5,[160,4,.6,100,2,.8,256,8,1],.35,0,0);H(a,6,[64,4,.2,160,3,.8,256,2,.5],.8,2,2);H(a,7,[96,3,.5,128,4,.75,192,6,1,256,8,.6],.4,0,2);H(a,8,[128,5,1,96,3,.5],.4,2,0);H(a,9,[160,8,1,128,6,.3],.4,0,0);H(a,10,[160,2,1,96,1,.5],.6,2,2);for(b=
0;2>b;++b)H(a,11+b,[128-8*b,8+2*b,1,96-8*b,4,.2],.3-.05*b,0,0);H(a,14,[112,4,.5,160,4,1,112,5,1,160,5,1,112,6,1,112,8,.8,160,8,.8,192,32,.5],.35,0,2);H(a,13,[130.81,15,.5,164.81,7.5,.7,146.83,7.5,1,174.61,7.5,1,164.81,7.5,1,196,15,1,220,30,.8],.35,0,0);H(a,15,[130.81,7.5,.2,146.83,7.5,.5,164.81,7.5,.7,146.83,7.5,1,130.81,7.5,1,146.83,7.5,1,164.81,7.5,1,174.61,30,.5],1.25,1,2);F(a,11)};
window.onload=()=>{var a=new Xa,b=a.g;const c=Ba();O(b,0,"f.png");O(b,1,"g.png");P(b,"t",new Ya(c),!0);P(b,"c",new ka);P(b,"ls",new Ua(c));P(b,"g",new Pa(c));P(b,"e",new la);Wa(a,0,Za,$a)};
